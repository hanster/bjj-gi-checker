<html>
    <head>
        <title>Liberator Example</title>
        <script type="text/javascript"
                src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
        </script>
        <style>
            table {
                border: 1px solid #666;
                width: 100%;
            }
            th {
                background: #f8f8f8;
                font-weight: bold;
                padding: 2px;
            }
            tr:nth-child(even) {
                background-color: #F5F5F5;
            }
        </style>

        <script type="text/javascript">

                function drawTable(data) {
                    var jsonOut = $('#json-out');
                    jsonOut.empty();
                    jsonOut.append(JSON.stringify(data, undefined, 2));
                    for (var i = 0; i < data.length; i++) {
                        drawRow(data[i]);
                    }
                }
                $(someSelector).wrap(function() {
                    var link = $('<a/>');
                    link.attr('href', 'somewhere_far_far_away');
                    link.text($(this).text());
                    return link;
                });

                var hrefLink = 'http://www.tatamifightwear.com/ProductDetails.asp?ProductCode=' +rowData.product_code;


                function drawRow(rowData) {
                    var row = $("<tr />");
                    $("#giStockTable").append(row); //this will append tr element to table... keep its reference for a while since we will add cels into it

                    var hrefLink = 'http://www.tatamifightwear.com/ProductDetails.asp?ProductCode=' +rowData.product_code;
                    var link = $('<a/>');
                    link.attr('href', hrefLink);
                    link.text(rowData.product_code);

                    row.append($("<td/>").append(link));
                    row.append($("<td>" + rowData.product_name + "</td>"));
                    row.append($("<td>" + rowData.available_sizes + "</td>"));
                    row.append($("<td>" + rowData.last_updated_date + "</td>"));
                }

                function handleError(xhr) {
                    $('#error').text(xhr.statusText + ": " + xhr.responseText);
                }

                function getGiStock() {
                    $.get("/get-gi", renderGi);
                }

                function getGiStockFromDb() {
                    $.get("/get-gi-from-db", drawTable);
                }

                function updateGiStock() {
                    $.get("/update-gi", function(data) {alert('Done');});
                }

        </script>
    </head>
    <body>
        <h1>Gi Stock Checker</h1>
        <button onclick="updateGiStock()">Update gi stock database</button>
        <button onclick="getGiStockFromDb()">Get gi stock from db (fast)</button>
        <table id="giStockTable">
            <tr>
                <th>Product Code</th>
                <th>Product Name</th>
                <th>Available Sizes</th>
                <th>Last Updated</th>
            </tr>

        </table>
        <p id="error"></p>
        <ul id="gi-list"></ul>
        <div id="json-out"></div>
    </body>
</html>
